/* ==========================================================================
   Sudoku — style.css (fixed: compact header, theme toggle reliability, mobile-like desktop)
   ========================================================================== */

/* -----------------------------
   CSS Variables (Light theme default)
   ----------------------------- */
:root {
  --bg: #ffffff;
  --bg-soft: #f6f7f9;
  --panel: #ffffff;
  --border: #e5e7eb;
  --text: #111827;
  --muted: #6b7280;
  --primary: #2563eb;
  --primary-ghost: rgba(37, 99, 235, 0.08);
  --accent: #0ea5e9;
  --danger: #ef4444;
  --ok: #059669;
  --shadow: 0 1px 2px rgba(0,0,0,.06), 0 8px 24px rgba(0,0,0,.06);

  --cell-size: 48px;          /* base cell size (desktop) */
  --cell-gap: 4px;            /* gap antar sel */
  --radius: 8px;              /* rounding */
  --font: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji";
  --container-max: 680px;     /* lebih sempit supaya desktop mirip mobile */
  --board-size: min(86vw, 460px); /* board lebih compact */
}

/* Explicit dark theme via toggle (JS sets data-theme="dark" on documentElement) */
/* Include multiple selectors to ensure JS toggles are applied reliably */
:root[data-theme="dark"],
html[data-theme="dark"],
body[data-theme="dark"],
.dark {
  --bg: #0b0f14;
  --bg-soft: #10161d;
  --panel: #0f141a;
  --border: #1f2937;
  --text: #e5e7eb;
  --muted: #9ca3af;
  --primary: #60a5fa;
  --primary-ghost: rgba(96, 165, 250, 0.15);
  --accent: #38bdf8;
  --danger: #f87171;
  --ok: #34d399;
  --shadow: 0 1px 2px rgba(0,0,0,.4), 0 10px 30px rgba(0,0,0,.35);
}

/* -----------------------------
   Base
   ----------------------------- */
*,
*::before,
*::after { box-sizing: border-box; }

html, body { height: 100%; }

body {
  margin: 0;
  font-family: var(--font);
  background: var(--bg);
  color: var(--text);
  line-height: 1.35;
  -webkit-font-smoothing:antialiased;
  -moz-osx-font-smoothing:grayscale;
}

/* container narrower to look like mobile even on desktop */
.container {
  max-width: var(--container-max);
  margin: 0 auto;
  padding: 6px; /* compact: reduced padding */
}

/* small helpers */
.visually-hidden {
  position: absolute !important;
  height: 1px; width: 1px;
  overflow: hidden; clip: rect(1px,1px,1px,1px);
  white-space: nowrap;
}

/* -----------------------------
   Header & Controls (compact, single-row)
   ----------------------------- */
.site-header {
  position: sticky;
  top: 0;
  z-index: 20;
  background: var(--bg);
  border-bottom: 1px solid var(--border);
  backdrop-filter: blur(6px);
  margin-bottom: 4px; /* bring info-bar closer */
}

.header-inner {
  display: flex;
  align-items: center;
  gap: 8px; /* slightly tighter */
  justify-content: space-between;
  padding: 6px 6px;     /* reduced */
  height: 44px;         /* shorter */
  box-sizing: border-box;
}

/* title smaller to save space */
.title {
  margin: 0;
  font-size: 1rem;
  font-weight: 700;
  letter-spacing: .2px;
  display:flex;
  align-items:center;
  gap:8px;
}

/* controls: don't wrap; allow horizontal scroll if overflow */
.controls {
  display: flex;
  gap: 6px; /* tighter */
  align-items: center;
  flex-wrap: nowrap;
  overflow-x: auto;
  padding-bottom: 0;
  -webkit-overflow-scrolling: touch;
}

/* hide scrollbars but still scrollable (lightweight) */
.controls::-webkit-scrollbar { height: 8px; }
.controls::-webkit-scrollbar-thumb { background: transparent; }

/* smaller control sizes */
select,
button {
  appearance: none;
  border: 1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  border-radius: 8px;
  padding: 6px 10px;
  font: 500 0.95rem/1 var(--font);
  cursor: pointer;
  transition: background .12s ease, border-color .12s ease, transform .06s ease;
  white-space: nowrap;
}

/* focus & hover */
select:focus,
button:focus {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}
button:hover { background: var(--bg-soft); }
button:active { transform: translateY(1px); }

/* small active states */
#toggle-pencil.active {
  border-color: var(--primary);
  box-shadow: inset 0 0 0 2px var(--primary-ghost);
  background: var(--primary-ghost);
}
#toggle-theme[aria-pressed="true"] {
  border-color: var(--accent);
  box-shadow: inset 0 0 0 2px var(--primary-ghost);
  background: var(--primary-ghost);
}

/* -----------------------------
   Info bar (compact)
   ----------------------------- */
.info-bar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;            /* tighter */
  padding: 6px 8px;    /* reduced */
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: var(--shadow);
  margin: 6px 0;       /* bring board closer */
  font-size: .95rem;
}

.status { display:flex; gap:8px; align-items:center; font-weight:600; }
#timer { font-variant-numeric: tabular-nums; }
#mistakes { color: var(--muted); font-weight:700; }
.instructions { color: var(--muted); font-size: .9rem; }

/* -----------------------------
   Game layout (mobile-like on desktop)
   ----------------------------- */
main.container {
  display: grid;
  grid-template-columns: 1fr;
  gap: 6px; /* tighter between sections */
}

.game { display:grid; gap:6px; }

/* smaller, compact board */
.sudoku-board {
  width: var(--board-size);
  aspect-ratio: 1 / 1;
  margin: 0 auto;
  display: grid;
  grid-template-columns: repeat(9, 1fr);
  grid-auto-rows: 1fr;
  gap: var(--cell-gap);
  padding: 6px; /* reduced */
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 8px;
  box-shadow: var(--shadow);
  position: relative;
  margin-top: 0;
  margin-bottom: 4px;
}

/* 3x3 separators simplified */
.sudoku-board::before,
.sudoku-board::after {
  content: "";
  position: absolute;
  inset: 8px;
  pointer-events: none;
  border-radius: 6px;
  background:
    linear-gradient(to right, transparent calc((100%/3) - 1px), var(--border) calc((100%/3) - 1px), var(--border) calc((100%/3) + 1px), transparent calc((100%/3) + 1px),
                               transparent calc((200%/3) - 1px), var(--border) calc((200%/3) - 1px), var(--border) calc((200%/3) + 1px), transparent calc((200%/3) + 1px)) ,
    linear-gradient(to bottom, transparent calc((100%/3) - 1px), var(--border) calc((100%/3) - 1px), var(--border) calc((100%/3) + 1px), transparent calc((100%/3) + 1px),
                               transparent calc((200%/3) - 1px), var(--border) calc((200%/3) - 1px), var(--border) calc((200%/3) + 1px), transparent calc((200%/3) + 1px));
  z-index: 0;
  opacity: .95;
}

/* cell wrapper compact */
.cell-wrapper { position: relative; z-index: 1; border-radius: 6px; overflow: hidden; }

/* cell style */
.cell {
  width: 100%;
  height: 100%;
  display: grid;
  place-items: center;
  border: 1px solid var(--border);
  background: var(--bg);
  color: var(--text);
  font-weight: 700;
  font-size: clamp(16px, 3.4vw, 20px);
  text-align: center;
  padding: 0;
  cursor: default;
}

.cell.given { background: var(--bg-soft); font-weight:800; color:var(--text); }
.cell:focus { outline: 2px solid var(--accent); outline-offset: -2px; }

/* notes/pencil */
.notes {
  position: absolute; inset: 0;
  display: grid; grid-template-columns: repeat(3,1fr); grid-auto-rows: 1fr;
  pointer-events: none; font-size: clamp(9px, 1.6vw, 11px); color:var(--muted);
}
.note { display:grid; place-items:center; opacity:.9; }

/* highlight styles */
.cell-wrapper.highlight-row .cell,
.cell-wrapper.highlight-col .cell,
.cell-wrapper.highlight-block .cell {
  background: color-mix(in oklab, var(--bg) 86%, var(--primary) 14%);
}
.cell-wrapper.highlight .cell { border-color: var(--accent); }

/* invalid */
.cell.invalid { border-color: var(--danger); color: var(--danger); animation: wiggle .22s ease; }
@keyframes wiggle { 0%{transform:translateX(0)}25%{transform:translateX(-4px)}50%{transform:translateX(3px)}100%{transform:translateX(0)} }

/* message */
.message { min-height: 16px; text-align:center; color:var(--muted); font-size:.95rem; margin-top:2px; margin-bottom:2px; }

/* side panel */
.side-panel { display:grid; gap:8px; }
.leaderboard { background:var(--panel); border:1px solid var(--border); border-radius:8px; padding:8px; }

/* -----------------------------
   Digit bank — fixes (paste at end, overrides previous rules)
   - square-ish buttons, centered content, stable counts
   - responsive: keeps 5 columns on small screens but buttons keep good aspect
   ----------------------------- */
.digit-bank {
  display: grid;
  grid-template-columns: repeat(5, minmax(0, 1fr));
  gap: 6px;               /* already compact */
  align-items: stretch;
  padding: 4px 2px;
  margin-top: 4px;
}

/* Make each button behave like a square tile with centered content.
   Use flex for reliable vertical alignment (instead of grid-template-rows). */
.digit-btn {
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  gap: 4px;
  padding: 6px;               /* smaller padding so content fits */
  min-height: 46px;          /* ensures touch target */
  aspect-ratio: 1 / 1;       /* keep near-square buttons */
  border-radius: 8px;
  border: 1px solid var(--border);
  background: var(--panel);
  color: var(--text);
  cursor: pointer;
  user-select: none;
  transition: transform .06s ease, background .12s ease, box-shadow .12s ease;
  box-shadow: none;
}

/* Hover / active affordances */
.digit-btn:hover { transform: translateY(-2px); box-shadow: 0 6px 14px rgba(0,0,0,.04); background: color-mix(in oklab, var(--panel) 92%, var(--bg-soft) 8%); }
.digit-btn:active { transform: translateY(0); box-shadow: none; }

/* Disabled state */
.digit-btn[disabled],
.digit-btn[aria-disabled="true"] {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

/* Digit and count styling */
.digit-btn .digit {
  font-weight: 800;
  font-size: clamp(1rem, 2.6vw, 1.1rem);
  line-height: 1;
  display: block;
  margin: 0;
}

.digit-btn .count {
  font-size: .72rem;
  color: var(--muted);
  font-variant-numeric: tabular-nums;
  display: block;
  line-height: 1;
}

/* Make erase button visually distinct if it's implemented as .digit-btn + #erase-btn */
#erase-btn {
  border-color: var(--border);
  background: linear-gradient(180deg, var(--panel), color-mix(in oklab, var(--panel) 92%, var(--danger) 8%));
}

/* If you want erase to be wider: let #erase-btn span two columns on grid layouts */
/* uncomment if desired:
#erase-btn {
  grid-column: span 2;
}
*/

/* Ensure responsive behaviour: on very narrow screens keep buttons usable */
@media (max-width: 360px) {
  .digit-btn { min-height: 42px; padding: 4px; gap: 3px; }
  .digit-btn .digit { font-size: .98rem; }
  .digit-btn .count { font-size: .68rem; }
}
